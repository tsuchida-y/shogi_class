# 将棋AIプレイヤー開発 ミニプロジェクト計画書

## I. プロジェクト概要

| 項目 | 詳細 |
| :--- | :--- |
| プロジェクト目標 | Pythonシミュレータを基盤とし、探索アルゴリズム(ミニマックス法)に基づいた初歩的なAIプレイヤーを実装し、人間と対局可能なシステムを完成させる。 |
| 技術スタック | Python (シミュレータ、AIロジック) |
| 作業形式 | グループ協調学習・開発 |

## II. フェーズ別要件定義

### 1. 基礎構築とルール完全準拠 (フェーズ1&2)
**目標:** シミュレータの盤面操作と、将棋の全合法手を生成できるようにする。

| ID | タスク | 責任者/状態 | 備考 |
| :--- | :--- | :--- | :--- |
| P1 | 盤面座標系の理解 | グループ全員 | (段, 筋)座標と、駒の非対称な前進方向(d_rankの符号)を明確に理解する。 |
| P2 | 成りのルール実装 | | 相手陣での移動・待機時に成るロジックを `make_move` に組み込む。 |
| P3 | 持ち駒を打つロジック | | 持ち駒から任意の空きマスに打つ `drop_piece` 関数を実装し、 `get_all_legal_moves` に統合する。 |
| P4 | 王手判定機能の追加 | | 現在の盤面が「王手」状態であるかを判定する `is_check(board, turn)` 関数を実装する。 |
| P5 | 特殊ルールによる制限 | | `get_all_legal_moves` に以下のフィルタリング処理を適用する:<br>①王手回避<br>②二歩禁止<br>③打ち歩詰め禁止<br>④行き所のない駒の禁止 |

### 2. AI探索アルゴリズムの実装 (フェーズ3)
**目標:** AIの「思考」を実装し、最善手を探索できるようにする。

#### 2.1. 評価関数 (Heuristic Evaluation)

| ID | 要件 | 評価点 | 備考 |
| :--- | :--- | :--- | :--- |
| E1 | 【必須】駒の基本価値 | 玉/王: 100万点 (事実上無限大) | AIの駒の合計価値 - 相手の駒の合計価値を返す。 |
| E2 | 飛車/龍王の価値 | 1000 / 1300点 | |
| E3 | 角行/龍馬の価値 | 800 / 1000点 | |
| E4 | 金将/銀将の価値 | 600 / 500点 | |
| E5 | 桂馬/香車/歩兵の価値 | 300 / 200 / 100点 | |
| E6 | 【拡張】玉の安全度 | 検討中 | 自分の玉の周囲のマスが守られているか、攻撃されていないかを評価に加える。 |
| E7 | 【拡張】駒の働き | 検討中 | 相手陣に近い駒、中央の駒にボーナス点を与える。 |

#### 2.2. 探索アルゴリズム

| ID | タスク | 備考 |
| :--- | :--- | :--- |
| A1 | ミニマックス法の実装 | `minimax(board, depth, is_maximizing_player)` 関数を実装。すべての合法手を探索し、再帰的に評価する。 |
| A2 | 探索深さの設定 | 最初の深さは `depth = 2` または3で設定し、計算速度を確認しながら調整する。 |
| A3 | 【最適化】Alpha-Beta法 | 必須。ミニマックス探索にアルファ・ベータ枝刈りを組み込み、探索効率を大幅に向上させる。 |

### 3. テストとユーザー対局 (フェーズ4)
**目標:** AIと人間が実際に遊べる対局環境を構築する。

| ID | タスク | 備考 |
| :--- | :--- | :--- |
| T1 | ユニットテストの作成 | フェーズ2で実装した合法手生成ロジック(王手回避、二歩など)の正しさを検証するテストケースを作成する。 |
| T2 | 対局メインループ | 人間(ユーザー入力)とAIが交互に指し手を行う `while game_not_over:` ループを実装する。 |
| T3 | 手番・状態管理 | `turn` 変数による正確な手番管理と、ゲーム終了 (詰み) の判定ロジックを実装する。 |
| T4 | ユーザー入力インターフェース | ユーザーが「移動元の座標」と「移動先の座標」を正確に入力できるインターフェースを実装する。 |

## III. 提出物と評価基準

* **提出物:** 完成した `shogi_simulator.py` ファイル(すべてのフェーズの機能を含む)および、プロジェクト計画書(本ドキュメント)への貢献度。
* **評価基準:**
    1.  合法手生成ロジック (P1-P5) が将棋のルールを正確に再現しているか。
    2.  ミニマックス探索とアルファ・ベータ法 (A1-A3)が正しく機能しているか。
    3.  AIの思考速度と強さ(特にAlpha-Beta法の効果)。
    4.  プロジェクトへのグループ内での貢献度と連携。